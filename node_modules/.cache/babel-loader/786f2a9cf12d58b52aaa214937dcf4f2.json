{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport { substitute, hasKey } from '@antv/util';\nimport { toPx, getTextPoint } from '../util/util';\nimport HtmlComponent from '../abstract/html-component';\nimport * as CssConst from './css-const';\nimport HtmlTheme from './html-theme';\nvar HtmlCrosshair = /** @class */function (_super) {\n  __extends(HtmlCrosshair, _super);\n  function HtmlCrosshair() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  HtmlCrosshair.prototype.getDefaultCfg = function () {\n    var cfg = _super.prototype.getDefaultCfg.call(this);\n    return __assign(__assign({}, cfg), {\n      name: 'crosshair',\n      type: 'html',\n      locationType: 'region',\n      start: {\n        x: 0,\n        y: 0\n      },\n      end: {\n        x: 0,\n        y: 0\n      },\n      capture: false,\n      text: null,\n      containerTpl: \"<div class=\\\"\" + CssConst.CONTAINER_CLASS + \"\\\"></div>\",\n      crosshairTpl: \"<div class=\\\"\" + CssConst.CROSSHAIR_LINE + \"\\\"></div>\",\n      textTpl: \"<span class=\\\"\" + CssConst.CROSSHAIR_TEXT + \"\\\">{content}</span>\",\n      domStyles: null,\n      containerClassName: CssConst.CONTAINER_CLASS,\n      defaultStyles: HtmlTheme,\n      defaultCfg: {\n        text: {\n          position: 'start',\n          content: null,\n          align: 'center',\n          offset: 10\n        }\n      }\n    });\n  };\n  HtmlCrosshair.prototype.render = function () {\n    this.resetText();\n    this.resetPosition();\n  };\n  // 绘制 crosshair\n  HtmlCrosshair.prototype.initCrossHair = function () {\n    var container = this.getContainer();\n    var crosshairTpl = this.get('crosshairTpl');\n    var crosshairEl = createDom(crosshairTpl);\n    container.appendChild(crosshairEl);\n    this.applyStyle(CssConst.CROSSHAIR_LINE, crosshairEl);\n    this.set('crosshairEl', crosshairEl);\n  };\n  // 获取文本的位置\n  HtmlCrosshair.prototype.getTextPoint = function () {\n    var _a = this.getLocation(),\n      start = _a.start,\n      end = _a.end;\n    var _b = this.get('text'),\n      position = _b.position,\n      offset = _b.offset;\n    return getTextPoint(start, end, position, offset);\n  };\n  // 设置 text\n  HtmlCrosshair.prototype.resetText = function () {\n    var text = this.get('text');\n    var textEl = this.get('textEl');\n    if (text) {\n      var content = text.content;\n      if (!textEl) {\n        var container = this.getContainer();\n        var textTpl = substitute(this.get('textTpl'), text);\n        textEl = createDom(textTpl);\n        container.appendChild(textEl);\n        this.applyStyle(CssConst.CROSSHAIR_TEXT, textEl);\n        this.set('textEl', textEl);\n      }\n      textEl.innerHTML = content;\n    } else if (textEl) {\n      textEl.remove();\n    }\n  };\n  // 是否垂直\n  HtmlCrosshair.prototype.isVertical = function (start, end) {\n    return start.x === end.x;\n  };\n  // 重新调整位置\n  HtmlCrosshair.prototype.resetPosition = function () {\n    var crosshairEl = this.get('crosshairEl');\n    if (!crosshairEl) {\n      this.initCrossHair();\n      crosshairEl = this.get('crosshairEl');\n    }\n    var start = this.get('start');\n    var end = this.get('end');\n    var minX = Math.min(start.x, end.x);\n    var minY = Math.min(start.y, end.y);\n    if (this.isVertical(start, end)) {\n      modifyCSS(crosshairEl, {\n        width: '1px',\n        height: toPx(Math.abs(end.y - start.y))\n      });\n    } else {\n      modifyCSS(crosshairEl, {\n        height: '1px',\n        width: toPx(Math.abs(end.x - start.x))\n      });\n    }\n    modifyCSS(crosshairEl, {\n      top: toPx(minY),\n      left: toPx(minX)\n    });\n    this.alignText();\n  };\n  HtmlCrosshair.prototype.alignText = function () {\n    // 重新设置 text 位置\n    var textEl = this.get('textEl');\n    if (textEl) {\n      var align = this.get('text').align;\n      var clientWidth = textEl.clientWidth;\n      var point = this.getTextPoint();\n      switch (align) {\n        case 'center':\n          point.x = point.x - clientWidth / 2;\n          break;\n        case 'right':\n          point.x = point.x - clientWidth;\n        case 'left':\n          break;\n      }\n      modifyCSS(textEl, {\n        top: toPx(point.y),\n        left: toPx(point.x)\n      });\n    }\n  };\n  HtmlCrosshair.prototype.updateInner = function (cfg) {\n    if (hasKey(cfg, 'text')) {\n      this.resetText();\n    }\n    _super.prototype.updateInner.call(this, cfg);\n  };\n  return HtmlCrosshair;\n}(HtmlComponent);\nexport default HtmlCrosshair;","map":{"version":3,"sources":["../../src/crosshair/html.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport { substitute, hasKey } from '@antv/util';\nimport { toPx, getTextPoint } from '../util/util';\nimport HtmlComponent from '../abstract/html-component';\nimport * as CssConst from './css-const';\nimport HtmlTheme from './html-theme';\nvar HtmlCrosshair = /** @class */ (function (_super) {\n    __extends(HtmlCrosshair, _super);\n    function HtmlCrosshair() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    HtmlCrosshair.prototype.getDefaultCfg = function () {\n        var cfg = _super.prototype.getDefaultCfg.call(this);\n        return __assign(__assign({}, cfg), { name: 'crosshair', type: 'html', locationType: 'region', start: { x: 0, y: 0 }, end: { x: 0, y: 0 }, capture: false, text: null, containerTpl: \"<div class=\\\"\" + CssConst.CONTAINER_CLASS + \"\\\"></div>\", crosshairTpl: \"<div class=\\\"\" + CssConst.CROSSHAIR_LINE + \"\\\"></div>\", textTpl: \"<span class=\\\"\" + CssConst.CROSSHAIR_TEXT + \"\\\">{content}</span>\", domStyles: null, containerClassName: CssConst.CONTAINER_CLASS, defaultStyles: HtmlTheme, defaultCfg: {\n                text: {\n                    position: 'start',\n                    content: null,\n                    align: 'center',\n                    offset: 10\n                }\n            } });\n    };\n    HtmlCrosshair.prototype.render = function () {\n        this.resetText();\n        this.resetPosition();\n    };\n    // 绘制 crosshair\n    HtmlCrosshair.prototype.initCrossHair = function () {\n        var container = this.getContainer();\n        var crosshairTpl = this.get('crosshairTpl');\n        var crosshairEl = createDom(crosshairTpl);\n        container.appendChild(crosshairEl);\n        this.applyStyle(CssConst.CROSSHAIR_LINE, crosshairEl);\n        this.set('crosshairEl', crosshairEl);\n    };\n    // 获取文本的位置\n    HtmlCrosshair.prototype.getTextPoint = function () {\n        var _a = this.getLocation(), start = _a.start, end = _a.end;\n        var _b = this.get('text'), position = _b.position, offset = _b.offset;\n        return getTextPoint(start, end, position, offset);\n    };\n    // 设置 text\n    HtmlCrosshair.prototype.resetText = function () {\n        var text = this.get('text');\n        var textEl = this.get('textEl');\n        if (text) {\n            var content = text.content;\n            if (!textEl) {\n                var container = this.getContainer();\n                var textTpl = substitute(this.get('textTpl'), text);\n                textEl = createDom(textTpl);\n                container.appendChild(textEl);\n                this.applyStyle(CssConst.CROSSHAIR_TEXT, textEl);\n                this.set('textEl', textEl);\n            }\n            textEl.innerHTML = content;\n        }\n        else if (textEl) {\n            textEl.remove();\n        }\n    };\n    // 是否垂直\n    HtmlCrosshair.prototype.isVertical = function (start, end) {\n        return start.x === end.x;\n    };\n    // 重新调整位置\n    HtmlCrosshair.prototype.resetPosition = function () {\n        var crosshairEl = this.get('crosshairEl');\n        if (!crosshairEl) {\n            this.initCrossHair();\n            crosshairEl = this.get('crosshairEl');\n        }\n        var start = this.get('start');\n        var end = this.get('end');\n        var minX = Math.min(start.x, end.x);\n        var minY = Math.min(start.y, end.y);\n        if (this.isVertical(start, end)) {\n            modifyCSS(crosshairEl, {\n                width: '1px',\n                height: toPx(Math.abs(end.y - start.y))\n            });\n        }\n        else {\n            modifyCSS(crosshairEl, {\n                height: '1px',\n                width: toPx(Math.abs(end.x - start.x))\n            });\n        }\n        modifyCSS(crosshairEl, {\n            top: toPx(minY),\n            left: toPx(minX)\n        });\n        this.alignText();\n    };\n    HtmlCrosshair.prototype.alignText = function () {\n        // 重新设置 text 位置\n        var textEl = this.get('textEl');\n        if (textEl) {\n            var align = this.get('text').align;\n            var clientWidth = textEl.clientWidth;\n            var point = this.getTextPoint();\n            switch (align) {\n                case 'center':\n                    point.x = point.x - clientWidth / 2;\n                    break;\n                case 'right':\n                    point.x = point.x - clientWidth;\n                case 'left':\n                    break;\n            }\n            modifyCSS(textEl, {\n                top: toPx(point.y),\n                left: toPx(point.x)\n            });\n        }\n    };\n    HtmlCrosshair.prototype.updateInner = function (cfg) {\n        if (hasKey(cfg, 'text')) {\n            this.resetText();\n        }\n        _super.prototype.updateInner.call(this, cfg);\n    };\n    return HtmlCrosshair;\n}(HtmlComponent));\nexport default HtmlCrosshair;\n//# sourceMappingURL=html.js.map"]},"metadata":{},"sourceType":"module"}