{"ast":null,"code":"/**\n * @fileoverview gradient\n * @author dengfuping_develop@163.com\n */\nimport { each, mod, toRadian, uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^)]+\\))/gi;\nfunction addStop(steps) {\n  var arr = steps.match(regexColorStop);\n  if (!arr) {\n    return '';\n  }\n  var stops = '';\n  arr.sort(function (a, b) {\n    a = a.split(':');\n    b = b.split(':');\n    return Number(a[0]) - Number(b[0]);\n  });\n  each(arr, function (item) {\n    item = item.split(':');\n    stops += \"<stop offset=\\\"\" + item[0] + \"\\\" stop-color=\\\"\" + item[1] + \"\\\"></stop>\";\n  });\n  return stops;\n}\nfunction parseLineGradient(color, el) {\n  var arr = regexLG.exec(color);\n  var angle = mod(toRadian(parseFloat(arr[1])), Math.PI * 2);\n  var steps = arr[2];\n  var start;\n  var end;\n  if (angle >= 0 && angle < 0.5 * Math.PI) {\n    start = {\n      x: 0,\n      y: 0\n    };\n    end = {\n      x: 1,\n      y: 1\n    };\n  } else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n    start = {\n      x: 1,\n      y: 0\n    };\n    end = {\n      x: 0,\n      y: 1\n    };\n  } else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n    start = {\n      x: 1,\n      y: 1\n    };\n    end = {\n      x: 0,\n      y: 0\n    };\n  } else {\n    start = {\n      x: 0,\n      y: 1\n    };\n    end = {\n      x: 1,\n      y: 0\n    };\n  }\n  var tanTheta = Math.tan(angle);\n  var tanTheta2 = tanTheta * tanTheta;\n  var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n  var y = tanTheta * (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.y;\n  el.setAttribute('x1', start.x);\n  el.setAttribute('y1', start.y);\n  el.setAttribute('x2', x);\n  el.setAttribute('y2', y);\n  el.innerHTML = addStop(steps);\n}\nfunction parseRadialGradient(color, self) {\n  var arr = regexRG.exec(color);\n  var cx = parseFloat(arr[1]);\n  var cy = parseFloat(arr[2]);\n  var r = parseFloat(arr[3]);\n  var steps = arr[4];\n  self.setAttribute('cx', cx);\n  self.setAttribute('cy', cy);\n  self.setAttribute('r', r);\n  self.innerHTML = addStop(steps);\n}\nvar Gradient = /** @class */function () {\n  function Gradient(cfg) {\n    this.cfg = {};\n    var el = null;\n    var id = uniqueId('gradient_');\n    if (cfg.toLowerCase()[0] === 'l') {\n      el = createSVGElement('linearGradient');\n      parseLineGradient(cfg, el);\n    } else {\n      el = createSVGElement('radialGradient');\n      parseRadialGradient(cfg, el);\n    }\n    el.setAttribute('id', id);\n    this.el = el;\n    this.id = id;\n    this.cfg = cfg;\n    return this;\n  }\n  Gradient.prototype.match = function (type, attr) {\n    return this.cfg === attr;\n  };\n  return Gradient;\n}();\nexport default Gradient;","map":{"version":3,"sources":["../../src/defs/gradient.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/**\n * @fileoverview gradient\n * @author dengfuping_develop@163.com\n */\nimport { each, mod, toRadian, uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^)]+\\))/gi;\nfunction addStop(steps) {\n    var arr = steps.match(regexColorStop);\n    if (!arr) {\n        return '';\n    }\n    var stops = '';\n    arr.sort(function (a, b) {\n        a = a.split(':');\n        b = b.split(':');\n        return Number(a[0]) - Number(b[0]);\n    });\n    each(arr, function (item) {\n        item = item.split(':');\n        stops += \"<stop offset=\\\"\" + item[0] + \"\\\" stop-color=\\\"\" + item[1] + \"\\\"></stop>\";\n    });\n    return stops;\n}\nfunction parseLineGradient(color, el) {\n    var arr = regexLG.exec(color);\n    var angle = mod(toRadian(parseFloat(arr[1])), Math.PI * 2);\n    var steps = arr[2];\n    var start;\n    var end;\n    if (angle >= 0 && angle < 0.5 * Math.PI) {\n        start = {\n            x: 0,\n            y: 0,\n        };\n        end = {\n            x: 1,\n            y: 1,\n        };\n    }\n    else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n        start = {\n            x: 1,\n            y: 0,\n        };\n        end = {\n            x: 0,\n            y: 1,\n        };\n    }\n    else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n        start = {\n            x: 1,\n            y: 1,\n        };\n        end = {\n            x: 0,\n            y: 0,\n        };\n    }\n    else {\n        start = {\n            x: 0,\n            y: 1,\n        };\n        end = {\n            x: 1,\n            y: 0,\n        };\n    }\n    var tanTheta = Math.tan(angle);\n    var tanTheta2 = tanTheta * tanTheta;\n    var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n    var y = (tanTheta * (end.x - start.x + tanTheta * (end.y - start.y))) / (tanTheta2 + 1) + start.y;\n    el.setAttribute('x1', start.x);\n    el.setAttribute('y1', start.y);\n    el.setAttribute('x2', x);\n    el.setAttribute('y2', y);\n    el.innerHTML = addStop(steps);\n}\nfunction parseRadialGradient(color, self) {\n    var arr = regexRG.exec(color);\n    var cx = parseFloat(arr[1]);\n    var cy = parseFloat(arr[2]);\n    var r = parseFloat(arr[3]);\n    var steps = arr[4];\n    self.setAttribute('cx', cx);\n    self.setAttribute('cy', cy);\n    self.setAttribute('r', r);\n    self.innerHTML = addStop(steps);\n}\nvar Gradient = /** @class */ (function () {\n    function Gradient(cfg) {\n        this.cfg = {};\n        var el = null;\n        var id = uniqueId('gradient_');\n        if (cfg.toLowerCase()[0] === 'l') {\n            el = createSVGElement('linearGradient');\n            parseLineGradient(cfg, el);\n        }\n        else {\n            el = createSVGElement('radialGradient');\n            parseRadialGradient(cfg, el);\n        }\n        el.setAttribute('id', id);\n        this.el = el;\n        this.id = id;\n        this.cfg = cfg;\n        return this;\n    }\n    Gradient.prototype.match = function (type, attr) {\n        return this.cfg === attr;\n    };\n    return Gradient;\n}());\nexport default Gradient;\n//# sourceMappingURL=gradient.js.map"]},"metadata":{},"sourceType":"module"}