{"ast":null,"code":"import { prettyNumber } from './pretty-number';\nexport default function pretty(min, max, m) {\n  if (m === void 0) {\n    m = 5;\n  }\n  if (min === max) {\n    return {\n      max: max,\n      min: min,\n      ticks: [min]\n    };\n  }\n  var n = m < 0 ? 0 : Math.round(m);\n  if (n === 0) return {\n    max: max,\n    min: min,\n    ticks: []\n  };\n  /*\n    R pretty:\n    https://svn.r-project.org/R/trunk/src/appl/pretty.c\n    https://www.rdocumentation.org/packages/base/versions/3.5.2/topics/pretty\n    */\n  var h = 1.5; // high.u.bias\n  var h5 = 0.5 + 1.5 * h; // u5.bias\n  // 反正我也不会调参，跳过所有判断步骤\n  var d = max - min;\n  var c = d / n;\n  // 当d非常小的时候触发，但似乎没什么用\n  // const min_n = Math.floor(n / 3);\n  // const shrink_sml = Math.pow(2, 5);\n  // if (Math.log10(d) < -2) {\n  //   c = (_.max([ Math.abs(max), Math.abs(min) ]) * shrink_sml) / min_n;\n  // }\n  var base = Math.pow(10, Math.floor(Math.log10(c)));\n  var unit = base;\n  if (2 * base - c < h * (c - unit)) {\n    unit = 2 * base;\n    if (5 * base - c < h5 * (c - unit)) {\n      unit = 5 * base;\n      if (10 * base - c < h * (c - unit)) {\n        unit = 10 * base;\n      }\n    }\n  }\n  var nu = Math.ceil(max / unit);\n  var ns = Math.floor(min / unit);\n  var hi = Math.max(nu * unit, max);\n  var lo = Math.min(ns * unit, min);\n  var size = Math.floor((hi - lo) / unit) + 1;\n  var ticks = new Array(size);\n  for (var i = 0; i < size; i++) {\n    ticks[i] = prettyNumber(lo + i * unit);\n  }\n  return {\n    min: lo,\n    max: hi,\n    ticks: ticks\n  };\n}","map":{"version":3,"sources":["../../src/util/pretty.ts"],"names":[],"mappings":"AAAA,SAAS,YAAY,QAAQ,iBAAiB;AAE9C,eAAc,SAAU,MAAM,CAAC,GAAW,EAAE,GAAW,EAAE,CAAa,EAAA;EAAb,IAAA,CAAA,KAAA,KAAA,CAAA,EAAA;IAAA,CAAA,GAAA,CAAa;EAAA;EACpE,IAAI,GAAG,KAAK,GAAG,EAAE;IACf,OAAO;MACL,GAAG,EAAA,GAAA;MACH,GAAG,EAAA,GAAA;MACH,KAAK,EAAE,CAAC,GAAG;KACZ;EACF;EAED,IAAM,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;EACnC,IAAI,CAAC,KAAK,CAAC,EAAE,OAAO;IAAE,GAAG,EAAA,GAAA;IAAE,GAAG,EAAA,GAAA;IAAE,KAAK,EAAE;EAAE,CAAE;EAE3C;;;;AAII;EACJ,IAAM,CAAC,GAAG,GAAG,CAAC,CAAC;EACf,IAAM,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC;EAC1B;EACA,IAAM,CAAC,GAAG,GAAG,GAAG,GAAG;EACnB,IAAM,CAAC,GAAG,CAAC,GAAG,CAAC;EACf;EACA;EACA;EACA;EACA;EACA;EAEA,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;EACpD,IAAI,IAAI,GAAG,IAAI;EACf,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE;IACjC,IAAI,GAAG,CAAC,GAAG,IAAI;IACf,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE;MAClC,IAAI,GAAG,CAAC,GAAG,IAAI;MACf,IAAI,EAAE,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE;QAClC,IAAI,GAAG,EAAE,GAAG,IAAI;MACjB;IACF;EACF;EACD,IAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC;EAChC,IAAM,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC;EAEjC,IAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,IAAI,EAAE,GAAG,CAAC;EACnC,IAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,IAAI,EAAE,GAAG,CAAC;EAEnC,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,GAAG,CAAC;EAC7C,IAAM,KAAK,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC;EAC7B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,EAAE;IAC7B,KAAK,CAAC,CAAC,CAAC,GAAG,YAAY,CAAC,EAAE,GAAG,CAAC,GAAG,IAAI,CAAC;EACvC;EAED,OAAO;IACL,GAAG,EAAE,EAAE;IACP,GAAG,EAAE,EAAE;IACP,KAAK,EAAA;GACN;AACH","sourceRoot":"","sourcesContent":["import { prettyNumber } from './pretty-number';\nexport default function pretty(min, max, m) {\n    if (m === void 0) { m = 5; }\n    if (min === max) {\n        return {\n            max: max,\n            min: min,\n            ticks: [min],\n        };\n    }\n    var n = m < 0 ? 0 : Math.round(m);\n    if (n === 0)\n        return { max: max, min: min, ticks: [] };\n    /*\n      R pretty:\n      https://svn.r-project.org/R/trunk/src/appl/pretty.c\n      https://www.rdocumentation.org/packages/base/versions/3.5.2/topics/pretty\n      */\n    var h = 1.5; // high.u.bias\n    var h5 = 0.5 + 1.5 * h; // u5.bias\n    // 反正我也不会调参，跳过所有判断步骤\n    var d = max - min;\n    var c = d / n;\n    // 当d非常小的时候触发，但似乎没什么用\n    // const min_n = Math.floor(n / 3);\n    // const shrink_sml = Math.pow(2, 5);\n    // if (Math.log10(d) < -2) {\n    //   c = (_.max([ Math.abs(max), Math.abs(min) ]) * shrink_sml) / min_n;\n    // }\n    var base = Math.pow(10, Math.floor(Math.log10(c)));\n    var unit = base;\n    if (2 * base - c < h * (c - unit)) {\n        unit = 2 * base;\n        if (5 * base - c < h5 * (c - unit)) {\n            unit = 5 * base;\n            if (10 * base - c < h * (c - unit)) {\n                unit = 10 * base;\n            }\n        }\n    }\n    var nu = Math.ceil(max / unit);\n    var ns = Math.floor(min / unit);\n    var hi = Math.max(nu * unit, max);\n    var lo = Math.min(ns * unit, min);\n    var size = Math.floor((hi - lo) / unit) + 1;\n    var ticks = new Array(size);\n    for (var i = 0; i < size; i++) {\n        ticks[i] = prettyNumber(lo + i * unit);\n    }\n    return {\n        min: lo,\n        max: hi,\n        ticks: ticks,\n    };\n}\n//# sourceMappingURL=pretty.js.map"]},"metadata":{},"sourceType":"module"}