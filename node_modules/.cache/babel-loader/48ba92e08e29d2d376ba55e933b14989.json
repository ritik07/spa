{"ast":null,"code":"\"use strict\";\n\nvar crypto = require(\"crypto\");\nclass PaytmChecksum {\n  static encrypt(input, key) {\n    var cipher = crypto.createCipheriv(\"AES-128-CBC\", key, PaytmChecksum.iv);\n    var encrypted = cipher.update(input, \"binary\", \"base64\");\n    encrypted += cipher.final(\"base64\");\n    return encrypted;\n  }\n  static decrypt(encrypted, key) {\n    var decipher = crypto.createDecipheriv(\"AES-128-CBC\", key, PaytmChecksum.iv);\n    var decrypted = decipher.update(encrypted, \"base64\", \"binary\");\n    try {\n      decrypted += decipher.final(\"binary\");\n    } catch (e) {\n      console.log(e);\n    }\n    return decrypted;\n  }\n  static generateSignature(params, key) {\n    if (typeof params !== \"object\" && typeof params !== \"string\") {\n      var error = \"string or object expected, \" + typeof params + \" given.\";\n      return Promise.reject(error);\n    }\n    if (typeof params !== \"string\") {\n      params = PaytmChecksum.getStringByParams(params);\n    }\n    return PaytmChecksum.generateSignatureByString(params, key);\n  }\n  static verifySignature(params, key, checksum) {\n    if (typeof params !== \"object\" && typeof params !== \"string\") {\n      var error = \"string or object expected, \" + typeof params + \" given.\";\n      return Promise.reject(error);\n    }\n    if (params.hasOwnProperty(\"CHECKSUMHASH\")) {\n      delete params.CHECKSUMHASH;\n    }\n    if (typeof params !== \"string\") {\n      params = PaytmChecksum.getStringByParams(params);\n    }\n    return PaytmChecksum.verifySignatureByString(params, key, checksum);\n  }\n  static async generateSignatureByString(params, key) {\n    var salt = await PaytmChecksum.generateRandomString(4);\n    return PaytmChecksum.calculateChecksum(params, key, salt);\n  }\n  static verifySignatureByString(params, key, checksum) {\n    var paytm_hash = PaytmChecksum.decrypt(checksum, key);\n    var salt = paytm_hash.substr(paytm_hash.length - 4);\n    return paytm_hash === PaytmChecksum.calculateHash(params, salt);\n  }\n  static generateRandomString(length) {\n    return new Promise(function (resolve, reject) {\n      crypto.randomBytes(length * 3.0 / 4.0, function (err, buf) {\n        if (!err) {\n          var salt = buf.toString(\"base64\");\n          resolve(salt);\n        } else {\n          console.log(\"error occurred in generateRandomString: \" + err);\n          reject(err);\n        }\n      });\n    });\n  }\n  static getStringByParams(params) {\n    var data = {};\n    Object.keys(params).sort().forEach(function (key, value) {\n      data[key] = params[key] !== null && params[key].toLowerCase() !== \"null\" ? params[key] : \"\";\n    });\n    return Object.values(data).join(\"|\");\n  }\n  static calculateHash(params, salt) {\n    var finalString = params + \"|\" + salt;\n    return crypto.createHash(\"sha256\").update(finalString).digest(\"hex\") + salt;\n  }\n  static calculateChecksum(params, key, salt) {\n    var hashString = PaytmChecksum.calculateHash(params, salt);\n    return PaytmChecksum.encrypt(hashString, key);\n  }\n}\nPaytmChecksum.iv = \"@@@@&&&&####$$$$\";\nmodule.exports = PaytmChecksum;","map":{"version":3,"names":["crypto","require","PaytmChecksum","encrypt","input","key","cipher","createCipheriv","iv","encrypted","update","final","decrypt","decipher","createDecipheriv","decrypted","e","console","log","generateSignature","params","error","Promise","reject","getStringByParams","generateSignatureByString","verifySignature","checksum","hasOwnProperty","CHECKSUMHASH","verifySignatureByString","salt","generateRandomString","calculateChecksum","paytm_hash","substr","length","calculateHash","resolve","randomBytes","err","buf","toString","data","Object","keys","sort","forEach","value","toLowerCase","values","join","finalString","createHash","digest","hashString","module","exports"],"sources":["/Users/apple/Documents/pp/doggiesthan app/spa/src/paytm-button/paytmChecksum.js"],"sourcesContent":["\"use strict\";\n\nvar crypto = require(\"crypto\");\n\nclass PaytmChecksum {\n  static encrypt(input, key) {\n    var cipher = crypto.createCipheriv(\"AES-128-CBC\", key, PaytmChecksum.iv);\n    var encrypted = cipher.update(input, \"binary\", \"base64\");\n    encrypted += cipher.final(\"base64\");\n    return encrypted;\n  }\n  static decrypt(encrypted, key) {\n    var decipher = crypto.createDecipheriv(\n      \"AES-128-CBC\",\n      key,\n      PaytmChecksum.iv\n    );\n    var decrypted = decipher.update(encrypted, \"base64\", \"binary\");\n    try {\n      decrypted += decipher.final(\"binary\");\n    } catch (e) {\n      console.log(e);\n    }\n    return decrypted;\n  }\n  static generateSignature(params, key) {\n    if (typeof params !== \"object\" && typeof params !== \"string\") {\n      var error = \"string or object expected, \" + typeof params + \" given.\";\n      return Promise.reject(error);\n    }\n    if (typeof params !== \"string\") {\n      params = PaytmChecksum.getStringByParams(params);\n    }\n    return PaytmChecksum.generateSignatureByString(params, key);\n  }\n\n  static verifySignature(params, key, checksum) {\n    if (typeof params !== \"object\" && typeof params !== \"string\") {\n      var error = \"string or object expected, \" + typeof params + \" given.\";\n      return Promise.reject(error);\n    }\n    if (params.hasOwnProperty(\"CHECKSUMHASH\")) {\n      delete params.CHECKSUMHASH;\n    }\n    if (typeof params !== \"string\") {\n      params = PaytmChecksum.getStringByParams(params);\n    }\n    return PaytmChecksum.verifySignatureByString(params, key, checksum);\n  }\n\n  static async generateSignatureByString(params, key) {\n    var salt = await PaytmChecksum.generateRandomString(4);\n    return PaytmChecksum.calculateChecksum(params, key, salt);\n  }\n\n  static verifySignatureByString(params, key, checksum) {\n    var paytm_hash = PaytmChecksum.decrypt(checksum, key);\n    var salt = paytm_hash.substr(paytm_hash.length - 4);\n    return paytm_hash === PaytmChecksum.calculateHash(params, salt);\n  }\n\n  static generateRandomString(length) {\n    return new Promise(function (resolve, reject) {\n      crypto.randomBytes((length * 3.0) / 4.0, function (err, buf) {\n        if (!err) {\n          var salt = buf.toString(\"base64\");\n          resolve(salt);\n        } else {\n          console.log(\"error occurred in generateRandomString: \" + err);\n          reject(err);\n        }\n      });\n    });\n  }\n\n  static getStringByParams(params) {\n    var data = {};\n    Object.keys(params)\n      .sort()\n      .forEach(function (key, value) {\n        data[key] =\n          params[key] !== null && params[key].toLowerCase() !== \"null\"\n            ? params[key]\n            : \"\";\n      });\n    return Object.values(data).join(\"|\");\n  }\n\n  static calculateHash(params, salt) {\n    var finalString = params + \"|\" + salt;\n    return crypto.createHash(\"sha256\").update(finalString).digest(\"hex\") + salt;\n  }\n  static calculateChecksum(params, key, salt) {\n    var hashString = PaytmChecksum.calculateHash(params, salt);\n    return PaytmChecksum.encrypt(hashString, key);\n  }\n}\nPaytmChecksum.iv = \"@@@@&&&&####$$$$\";\nmodule.exports = PaytmChecksum;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}