{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { each, isArray, isObject } from '@antv/util';\nimport { SVG_ATTR_MAP } from '../constant';\nimport ShapeBase from './base';\nvar Path = /** @class */function (_super) {\n  __extends(Path, _super);\n  function Path() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.type = 'path';\n    _this.canFill = true;\n    _this.canStroke = true;\n    return _this;\n  }\n  Path.prototype.getDefaultAttrs = function () {\n    var attrs = _super.prototype.getDefaultAttrs.call(this);\n    return __assign(__assign({}, attrs), {\n      startArrow: false,\n      endArrow: false\n    });\n  };\n  Path.prototype.createPath = function (context, targetAttrs) {\n    var _this = this;\n    var attrs = this.attr();\n    var el = this.get('el');\n    each(targetAttrs || attrs, function (value, attr) {\n      if (attr === 'path' && isArray(value)) {\n        el.setAttribute('d', _this._formatPath(value));\n      } else if (attr === 'startArrow' || attr === 'endArrow') {\n        if (value) {\n          var id = isObject(value) ? context.addArrow(attrs, SVG_ATTR_MAP[attr]) : context.getDefaultArrow(attrs, SVG_ATTR_MAP[attr]);\n          el.setAttribute(SVG_ATTR_MAP[attr], \"url(#\" + id + \")\");\n        } else {\n          el.removeAttribute(SVG_ATTR_MAP[attr]);\n        }\n      } else if (SVG_ATTR_MAP[attr]) {\n        el.setAttribute(SVG_ATTR_MAP[attr], value);\n      }\n    });\n  };\n  Path.prototype._formatPath = function (value) {\n    var newValue = value.map(function (path) {\n      return path.join(' ');\n    }).join('');\n    if (~newValue.indexOf('NaN')) {\n      return '';\n    }\n    return newValue;\n  };\n  /**\n   * Get total length of path\n   * 尽管通过浏览器的 SVGPathElement.getTotalLength() 接口获取的 path 长度，\n   * 与 Canvas 版本通过数学计算的方式得到的长度有一些细微差异，但最大误差在个位数像素，精度上可以能接受\n   * @return {number} length\n   */\n  Path.prototype.getTotalLength = function () {\n    var el = this.get('el');\n    return el ? el.getTotalLength() : null;\n  };\n  /**\n   * Get point according to ratio\n   * @param {number} ratio\n   * @return {Point} point\n   */\n  Path.prototype.getPoint = function (ratio) {\n    var el = this.get('el');\n    var totalLength = this.getTotalLength();\n    // @see https://github.com/antvis/g/issues/634\n    if (totalLength === 0) {\n      return null;\n    }\n    var point = el ? el.getPointAtLength(ratio * totalLength) : null;\n    return point ? {\n      x: point.x,\n      y: point.y\n    } : null;\n  };\n  return Path;\n}(ShapeBase);\nexport default Path;","map":{"version":3,"sources":["../../src/shape/path.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { each, isArray, isObject } from '@antv/util';\nimport { SVG_ATTR_MAP } from '../constant';\nimport ShapeBase from './base';\nvar Path = /** @class */ (function (_super) {\n    __extends(Path, _super);\n    function Path() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = 'path';\n        _this.canFill = true;\n        _this.canStroke = true;\n        return _this;\n    }\n    Path.prototype.getDefaultAttrs = function () {\n        var attrs = _super.prototype.getDefaultAttrs.call(this);\n        return __assign(__assign({}, attrs), { startArrow: false, endArrow: false });\n    };\n    Path.prototype.createPath = function (context, targetAttrs) {\n        var _this = this;\n        var attrs = this.attr();\n        var el = this.get('el');\n        each(targetAttrs || attrs, function (value, attr) {\n            if (attr === 'path' && isArray(value)) {\n                el.setAttribute('d', _this._formatPath(value));\n            }\n            else if (attr === 'startArrow' || attr === 'endArrow') {\n                if (value) {\n                    var id = isObject(value)\n                        ? context.addArrow(attrs, SVG_ATTR_MAP[attr])\n                        : context.getDefaultArrow(attrs, SVG_ATTR_MAP[attr]);\n                    el.setAttribute(SVG_ATTR_MAP[attr], \"url(#\" + id + \")\");\n                }\n                else {\n                    el.removeAttribute(SVG_ATTR_MAP[attr]);\n                }\n            }\n            else if (SVG_ATTR_MAP[attr]) {\n                el.setAttribute(SVG_ATTR_MAP[attr], value);\n            }\n        });\n    };\n    Path.prototype._formatPath = function (value) {\n        var newValue = value\n            .map(function (path) {\n            return path.join(' ');\n        })\n            .join('');\n        if (~newValue.indexOf('NaN')) {\n            return '';\n        }\n        return newValue;\n    };\n    /**\n     * Get total length of path\n     * 尽管通过浏览器的 SVGPathElement.getTotalLength() 接口获取的 path 长度，\n     * 与 Canvas 版本通过数学计算的方式得到的长度有一些细微差异，但最大误差在个位数像素，精度上可以能接受\n     * @return {number} length\n     */\n    Path.prototype.getTotalLength = function () {\n        var el = this.get('el');\n        return el ? el.getTotalLength() : null;\n    };\n    /**\n     * Get point according to ratio\n     * @param {number} ratio\n     * @return {Point} point\n     */\n    Path.prototype.getPoint = function (ratio) {\n        var el = this.get('el');\n        var totalLength = this.getTotalLength();\n        // @see https://github.com/antvis/g/issues/634\n        if (totalLength === 0) {\n            return null;\n        }\n        var point = el ? el.getPointAtLength(ratio * totalLength) : null;\n        return point\n            ? {\n                x: point.x,\n                y: point.y,\n            }\n            : null;\n    };\n    return Path;\n}(ShapeBase));\nexport default Path;\n//# sourceMappingURL=path.js.map"]},"metadata":{},"sourceType":"module"}